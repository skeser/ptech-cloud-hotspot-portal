$(function(){$("#sms-validation-div").hide(),$("#mac-register-div").hide(),$("#info").hide(),$("#warn").hide(),$("#error").hide();var a=$("#portal_action").val();let o=!1,i=300,t=$("#countdown");$.ajax({type:"GET",url:"http://portal.il.technexus.com/api/v1/is-alive",dataType:"json"}).done(function(e){c("is_alive",e=e),"is_live-error-1"===e.event_code&&($("#mac-register-div").hide(),n(e))}).fail(function(e,o,a){d(0,e,o,a),s("err : service unavailable (503)")});var e={mac:$("#mac_mac_check").val(),ip:$("#ip_mac_check").val()};function n(e){"info"===e.type&&($("#info").show().html(e.message),$("#warn").hide(),$("#error").hide()),"warn"===e.type&&($("#info").hide(),$("#warn").show().html(e.message),$("#error").hide()),"error"===e.type&&($("#info").hide(),$("#warn").hide(),$("#error").show().html(e.message))}function s(e){$("#mac-register-div").hide(),$("#sms-validation-div").hide(),$("#info").hide(),$("#warn").hide(),$("#error").show().html(e)}function r(){location.reload(),$(location).attr("href","https://teamworking.vc/"),window.open("https://teamworking.vc/","_blank").focus()}function l(e){$("#cell_phone_sms_request").val(e)}function c(e,o){console.log("BEGIN : DEBUG "),console.log("SOURCE : "+e),console.log("+type : "+o.type),console.log("+event_code : "+o.event_code),console.log("+message : "+o.message),console.log("+phone : "+o.phone),console.log("+sms_validation_mod : "+o.sms_validation_mod),console.log("END : DEBUG -------------------------------------------")}function d(e,o,a,i){console.log("BEGIN : debugFail"),console.log("|xhr    : "+o),console.log("|status : "+a),console.log("|error  : "+i),console.log("END : debugFail")}function m(){var e,o;console.log("startCountdown worked"),0<i?(i--,e=Math.floor(i/60),o=i%60,t.text(e+":"+(o<10?"0":"")+o),setTimeout(m,1e3)):location.reload()}$.ajax({type:"POST",url:"http://portal.il.technexus.com/api/v1/mac-status-check",data:e}).done(function(e){c("mac-check",e=e),"mchk-warn-3"!==e.event_code&&"mchk-warn-2"!==e.event_code&&"mchk-warn-6"!==e.event_code||n(e),"mchk-info-1"===e.event_code&&(n(e),r()),"mchk-warn-1"!==e.event_code&&"mchk-warn-4"!==e.event_code||$("#mac-register-div").show(),"mchk-info-2"===e.event_code&&(n(e),r()),"mchk-warn-5"===e.event_code&&(l(e.phone),$("#sms-validation-div").show(),n(e)),"mchk-error-1"===e.event_code&&n(e)}).fail(function(e,o,a){d(0,e,o,a),s("err : service unavailable (mac status check fail)")}),$("#mac-register-form").on("submit",function(e){e.preventDefault();e={cell_phone:$("#cell_phone").val(),firstName:$("#firstName").val(),lastName:$("#lastName").val(),email:$("#email").val(),mac:$("#mac_mac_register").val(),ip:$("#ip_mac_register").val()};$.ajax({url:"http://portal.il.technexus.com/api/v1/mac-portal-form-save",type:"POST",data:e}).done(function(e){!function(o){if(c("mac_register_form_response : ",o),"mreg-warn-2"!==o.event_code&&"mreg-warn-2"!==o.event_code||($("#mac-register-div").hide(),n(o)),"mreg-info-1"===o.event_code){$("#mac-register-div").hide(),n(o);let e=new XMLHttpRequest;e.open("GET",a,!0),e.send(),e=function(e,o){0!==e.readyState&&4!==e.readyState&&e.abort();const a=new XMLHttpRequest;return a.open("GET",o,!0),a.onload=function(){console.log("Uzak sunucuyla yeni bir bağlantı kuruldu.")},a}(e,a),console.log("xhr : "+e),function(){var e={redirurl:$("#redirurl").val(),zone:$("#zone").val(),mac:$("#mac").val(),ip:$("#ip").val()};$.ajax({type:"POST",url:$("#portal_action").val(),data:e}).done(function(e){console.log("captiveportal form post success"+e)}).fail(function(e,o,a){console.log("captiveportal form post NOT success"+a+e+o)})}(),r()}"mreg-warn-3"===o.event_code&&($("#mac-register-div").hide(),l(o.phone),$("#sms-validation-div").show(),n(o)),"mreg-error-1"===o.event_code&&($("#mac-register-div").hide(),$("#sms-validation-div").hide(),n(o))}(e)}).fail(function(e,o,a){d(0,e,o,a),s("err : service unavailable (mac register service fail)")})}),$("#sms-request-form").on("submit",function(e){e.preventDefault(),!1===o&&$("#sms-request-form-result").html("please wait, sending.."),o=!0;e={cell_phone:$("#cell_phone_sms_request").val(),mac:$("#mac_sms_request").val(),ip:$("#ip_sms_request").val()};$.ajax({url:"http://portal.il.technexus.com/api/v1/sms-request-form",type:"POST",data:e}).done(function(e){c("sms_request_service_form_post_done : ",e=e),"sms_req-warn-1"!==e.event_code&&"sms_req-warn-2"!==e.event_code||($("#mac-register-div").hide(),$("#sms-request-form").hide(),n(e)),"sms_req-info-1"===e.event_code&&0===e.sms_validation_mod&&($("#mac-register-div").hide(),$("#sms-request-form").hide(),r()),"sms_req-info-1"===e.event_code&&1===e.sms_validation_mod&&($("#warn").hide(),$("#sms-validation-form-result").html(""),m(),l(e.phone),$("#cell_phone_validation").attr("value",e.phone),$("#mac-register-div").hide(),$("#sms-validation-div").show(),$("#sms-request-form-result").html(e.message)),"sms_req-warn-3"===e.event_code&&1===e.sms_validation_mod&&(o=!0,$("#sms-request-form-result").html(""),n(e)),"sms_req-error-1"===e.event_code&&1===e.sms_validation_mod&&n(e),"sms_req-error-2"===e.event_code&&1===e.sms_validation_mod&&n(e)}).fail(function(e,o,a){d(0,e,o,a),s("err : service unavailable (sms sending service fail)")})}),$("#sms-validation-form").on("submit",function(e){e.preventDefault();e={cell_phone_verification_code:$("#cell_phone_verification_code").val(),cell_phone_validation:"undefined",mac:$("#mac_sms_validation_code").val(),ip:$("#ip_sms_validation_code").val()};$.ajax({url:"http://portal.il.technexus.com/api/v1/sms-validation-form",type:"POST",data:e}).done(function(e){c("sms_validation_form_post_DONE",e=e),"sms_val-warn-1"!==e.event_code&&"sms_val-warn-2"!==e.event_code||($("#mac-register-div").hide(),$("#sms-request-form").hide(),n(e)),"sms_val-warn-3"===e.event_code&&($("#mac-register-div").hide(),$("#sms-validation-div").show(),n(e)),"sms_val-warn-4"===e.event_code&&($("#mac-register-div").hide(),$("#sms-validation-div").show(),$("#sms-validation-form-result").html(e.message)),"sms_val-error-1"===e.event_code&&($("#mac-register-div").hide(),$("#sms-validation-div").show(),n(e)),"sms_val-info-1"===e.event_code&&($("#mac-register-div").hide(),$("#sms-validation-div").hide(),n(e),r()),"sms_val-error-1"===e.event_code&&($("#mac-register-div").hide(),$("#sms-validation-div").show(),n(e))}).fail(function(e,o,a){d(0,e,o,a),s("err : service unavailable (sms validation service fail)")})}),$("#captive_portal_login_form").on("submit",function(e){return e.preventDefault(),console.log("captive_portal_login_form worked you are use redirect to internet"),alert("captive_portal_login_form worked you are use redirect to internet"),!0})});